function settings(e){this.organization=e,this.handlers={screen_size:{url:root+"options/screen_size",property:"detection_string",response_key:"Screen_Sizes"},floor:{fill_values:{building:".building_select"},url:root+"options/floor",query_parameters:{organization:this.organization},property:"name",query_key:"name",type:"typeahead",response_key:"Floors"},location:{url:root+"options/location?organization="+this.organization,property:"name",response_key:"Locations"},manufacturer:{url:root+"options/manufacturer",query_key:"name",property:"name",type:"typeahead",response_key:"Manufacturers"},device_type:{url:root+"options/device_type",property:"name",response_key:"Device_Types"},computer_model:{url:root+"options/computer_model",property:"name",query_key:"name",fill_values:{type:".type_select"},type:"typeahead",response_key:"Computer_Models"},device_model:{url:root+"options/device_model",property:"name",query_key:"name",fill_values:{type:".type_select"},type:"typeahead",response_key:"Device_Models"},printer_model:{url:root+"options/printer_model",property:"name",query_key:"name",type:"typeahead",response_key:"Printer_Models"},building:{url:root+"options/building?organization="+this.organization,property:"name",response_key:"Buildings"}}}function tableGenerator(e){this.requestType=e.requestType,this.container=e.container,this.localStorageColumnsKey=e.localStorageColumnsKey||"columns",this.modal_id_name=e.modal_id_name||this.randomString(10),this.localStorageLengthKey=e.localStorageLengthKey||"length_value",this.filter_value=localStorage.getItem(this.localStorageLengthKey)||10,$.parseJSON(localStorage.getItem(this.localStorageColumnsKey))&&this.countProperties($.parseJSON(localStorage.getItem(this.localStorageColumnsKey)))==this.countProperties(e.columns)?this.columns=$.parseJSON(localStorage.getItem(this.localStorageColumnsKey)):this.columns=e.columns,this.responseNode=e.responseNode,this.multipleResponseNode=e.multipleResponseNode,this.multipleRequestType=e.multipleRequestType,this.root=e.root.indexOf("http")==-1?window.location.protocol+"://"+e.root:e.root,typeof e.callback!="undefined"&&(this.doneCallback=e.callback),typeof e.modal!="undefined"&&(this.onCickModal=e.modal),typeof e.handlers!="undefined"&&(this.handlers=e.handlers),typeof e.organization!="undefined"&&(this.organization=e.organization),typeof this.getCookie("token")!=undefined&&(this.token=this.getCookie("token"))}function getPage(){var e=History.getState();return page=e.cleanUrl.replace(root,""),page=page.replace("http://",""),page=page.replace("https://",""),page=page.replace("//",""),page=page.replace("www.",""),page}function initialize(){page=getPage(),$("#"+page).length>0&&($(".active_page").addClass("disabled_page").removeClass("active_page"),$("#"+page).removeClass("disabled_page").addClass("active_page"),$('a[data-target="'+findPageString(page)+'"]').length>0&&!$('a[data-target="'+findPageString(page)+'"]').parent("li").hasClass("active")&&($(".active").removeClass("active"),$('a[data-target="'+findPageString(page)+'"]').parent("li").addClass("active")))}function showPage(){var e=$(".active_page");if(objx.get(generators,e.attr("id"))!=null){var t=objx.get(generators,e.attr("id"));objx.get(application,t).hide()}page=getPage(),$("#"+page).length>0&&($(".active_page").addClass("disabled_page").removeClass("active_page"),$("#"+page).removeClass("disabled_page").addClass("active_page"),$('a[data-target="'+findPageString(page)+'"]').length>0&&!$('a[data-target="'+findPageString(page)+'"]').parent("li").hasClass("active")&&($(".active").removeClass("active"),$('a[data-target="'+findPageString(page)+'"]').parent("li").addClass("active")));var n=$("#"+page);n.length==0&&(n=e);if(objx.get(generators,n.attr("id"))!=null){var t=objx.get(generators,n.attr("id"));objx.get(application,t)!=null&&objx.get(application,t).show()}}function findPageString(e){var t="";return $.each(data,function(n,r){r==e&&(t=n)}),t}settings.prototype={organization:null,computerColumns:{identifier:{string:"Identifier",active:!0},"screen_size.detection_string":{string:"Screen Size",active:!0},"model.type.name":{string:"Type",active:!0},"model.name":{string:"Model",active:!0},"location.name":{string:"Location",active:!1},lan_mac:{string:"Lan Mac",active:!1},wifimac:{string:"Wifi Mac",active:!1},ip:{string:"Ip",active:!1},disk_space:{string:"Disk",active:!1},"memory.total_physical_memory":{string:"Memory",active:!0},"model.manufacturer.abbrevation":{string:"Manufacturer",active:!1},serial:{string:"Serial",active:!1},power_usage_per_hour:{string:"Power",active:!1},created_time:{string:"Time created",active:!0},last_updated:{string:"Last updated",active:!1},"creator_user.name":{string:"Creator",active:!1},"last_updated_user.name":{string:"Last updated by",active:!1}},unitColumns:{identifier:{string:"Identifier",active:!0},description:{string:"Description",active:!0},"model.name":{string:"Model",active:!0},"model.manufacturer.name":{string:"Manufacturer",active:!1},"model.type.name":{string:"Type",active:!1},"location.name":{string:"Location",active:!1},created_time:{string:"Time created",active:!1},serial:{string:"Serial",active:!1}},locationColumns:{name:{string:"Name",active:!0},room_number:{string:"Room Number",active:!0},"floor.name":{string:"Floor",active:!1},"building.name":{string:"Building",active:!1}},printerColumns:{identifier:{string:"Identifier",active:!0},name:{string:"Name",active:!0},"model.name":{string:"Model",active:!0},"model.manufacturer.name":{string:"Manufacturer",active:!1},"location.name":{string:"Location",active:!0},"location.room_number":{string:"Room Number",active:!1}},screenColumns:{identifier:{string:"Identifier",active:!0},"location.name":{string:"Location",active:!0},"model.name":{string:"Model",active:!1},"model.manufacturer":{string:"Manufacturer",active:!1},"scren_size.detection_string":{string:"Screen Size",active:!1},"screen_size.aspect_ratio":{string:"Aspect ratio",active:!1}},handlers:{}},tableGenerator.prototype={requestUrl:null,token:null,localStorageLengthKey:null,localStorageColumnsKey:null,modal_id_name:null,requestType:"computer",root:null,multipleRequestType:"computers",handlers:null,container:$("#computer"),responseNode:"Computer",onCickModal:null,doneCallback:null,multipleResponseNode:"Computers",columns:null,storedVariables:{},fixedHeader:null,fixedHeaderElement:null,initialize:!0,readyCallback:function(){this.generateTable(),this.doneCallback!=null&&this.doneCallback(),this.hide()},response:null,organization:null,filter_value:10,dataTable:null,length_menu:'<form class="jqtransform"><select class="length_select"><option selected="selected">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option></select></form>',generateNode:function(e,t){var n=$("<tr></tr>");if(e!=null&&e!=undefined){n.attr("data-index",t);var r=0;$.each(this.columns,$.proxy(function(t,s){r++;if(this.columns[t].active==1){var o=objx.get(e,t);o!==undefined&&o!==null&&o!==-1&&o!==!1?n.append("<th>"+o.toString()+"</th>"):n.append("<th></th>")}r==this.countProperties(this.columns)&&(n.append('<th class="table-button-column"><a class="btn delete-button table-button" data-launch="false">Delete</a><a class="btn edit-button table-button">Edit</a></th>'),this.container.find("tbody").append(n),this.ensureLayout())},this))}},getCookie:function(e){var t,n,r,i=document.cookie.split(";");for(t=0;t<i.length;t++){n=i[t].substr(0,i[t].indexOf("=")),r=i[t].substr(i[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,"");if(n==e)return unescape(r)}},setCookie:function(e,t,n){var r=new Date;r.setDate(r.getDate()+n);var i=escape(t)+(n==null?"":"; expires="+r.toUTCString());document.cookie=e+"="+i},randomString:function(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",e=e||8,n="";for(var r=0;r<e;r++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n},countProperties:function(e){var t,n=0;for(t in e)n++;return n},createAutherizedUrl:function(e,t){return t=t||this.token,t!=null&&e.indexOf("token="+t)==-1&&(e.indexOf("?")==-1?e+="?":e+="&",e+="token="+t),e},hide:function(){$(this.fixedHeaderElement).hide()},show:function(){this.fixedHeader==null?(this.fixedHeader=new FixedHeader(this.dataTable,{offsetTop:40}),this.fixedHeaderElement=this.fixedHeader.fnGetSettings().aoCache[0].nWrapper):($(this.fixedHeaderElement).show(),this.fixedHeader.fnUpdate()),this.fixedHeader.fnFix(),this.fixedHeader.fnPosition()},getNodes:function(e){var t=this.root+"get/"+this.multipleRequestType+"/{id}";t=t.replace("{id}",e),t=this.createAutherizedUrl(t),$.ajax({url:this.createAutherizedUrl(t),timeoutNumber:2500,success:$.proxy(function(e,t,n){e!=null&&(this.response=objx.get(e,this.multipleResponseNode),e=this.response,e!=null&&e!=undefined&&$.each(e,$.proxy(function(t,n){typeof n!="undefined"&&typeof n.id!="undefined"&&this.generateNode(n,n.id),e!=null&&t==e.length-1?this.readyCallback():e==null&&this.readyCallback()},this)))},this),error:$.proxy(function(){this.readyCallback(),this.showError("No ressource could be found or an error occured!",$("#error_container"))},this)})},getNode:function(e,t){var n=this.root+this.requestType+"/{id}";$.ajax({url:this.createAutherizedUrl(n.replace("{id}",e)),success:$.proxy(function(e){e=objx.get(e,this.responseNode),this.generateNode(e),this.readyCallback()},this)})},getInfo:function(e,t){return t=t||this.token||null,info=null,$.ajax({url:this.createAutherizedUrl(e,t),success:$.proxy(function(e){info=e},this)}),info},generateFieldsDropdown:function(e,t){var n=$(this.container).parent("div"),r=$('<ul class="nav fields-select nav-pills"></ul>'),i=$('<li class="dropdown"></li>'),s=$('<a class="dropdown-toggle" data-toggle="dropdown" data-target="#">'+e+'<b class="caret"></b></a>'),o=$('<ul class="dropdown-menu inputs-list"></ul>'),u=this.countProperties(this.columns),a=0;$.each(this.columns,$.proxy(function(e,f){e!==""&&typeof f=="object"&&(a++,this.columns[e].active==1?o.append('<li><a href="#"><input type="checkbox" class="styled" name="'+e+'" value="'+e+'" id="'+e+'" checked/> '+'  <label for="'+e+'">'+f.string+"</label>"+"</a>"+"</li>"):o.append('<li><a href="#"><input type="checkbox" class="styled" name="'+e+'" value="'+e+'" "/> '+'  <label for="'+e+'">'+f.string+"</label>"+"</a>"+"</li>"),a==u&&(i.append(s),i.append(o),r.append(i),t.append(r),Custom.init(n),$(n).find(".dropdown-menu li a").click(function(e){$(e.target).find("span").parent().find('input[type="checkbox"]').prop("checked",!0),$(e.target).find("span").trigger("click")}),$(n).find(".dropdown-menu li span").click($.proxy(function(e){var t=$(e.target).parent().find('input[type="checkbox"]');t.prop("checked")===!0?this.columns[t.val()].active=!0:this.columns[t.val()].active=!1,this.findSortedColumns(),localStorage.setItem(this.localStorageColumnsKey,JSON.stringify(this.columns)),this.refreshTable()},this))))},this))},findSortedColumns:function(){if($(this.fixedHeaderElement).length>0){var e=$(this.fixedHeaderElement).find("thead th[aria-sort]"),t=this.getSortColumn();typeof t!=undefined&&t!=null&&e.length>0&&t.column!=e.attr("data-column")&&delete this.columns[t.column].sort,this.initialize!=1&&($.each(this.columns,$.proxy(function(t,n){t==$(e).attr("data-column")&&(this.columns[t].sort=e.attr("aria-sort"))},this)),localStorage.setItem(this.localStorageColumnsKey,JSON.stringify(this.columns)))}},ensureLayout:function(){$("tbody td:odd").addClass("odd"),$("tbody td:even").addClass("even"),this.response!=undefined&&$(this.container).find("table").find(".dataTables_empty").remove()},generateTable:function(){this.generateColumns(),this.initializeDatatables(!0),this.onCickModal!=null&&this.createModal()},generateColumns:function(){var e=$("<tr></tr>");$.each(this.columns,$.proxy(function(t,n){n.active===!0&&e.append('<th data-column="'+t+'">'+n.string+"</th>")},this)),e.append("<th>Actions</th>"),this.container.find("thead").append(e)},getSortColumn:function(){var e=null,t=null,n=null;return $.each(this.columns,$.proxy(function(e,r){if(r.active===!0&&typeof r.sort!="undefined"){t=r.sort=="descending"?"desc":"asc";var i=$(this.container).find('thead tr th[data-column="'+e+'"]').index();n={element:i,option:t,column:e,columnOptions:r}}},this)),n},initializeDatatables:function(e){this.redraw=!0;var t=$("#"+$(this.container).parent("div").attr("id")),n=this.getSortColumn(),r=n!=undefined?[[n.element,n.option]]:null,i={sDom:"<'row-fluid'<'span4'l<'fields'>><'span4 offset4'f>r>t<'row-fluid'<'span6'i><'span6'p>>",sPaginationType:"bootstrap",oLanguage:{sLengthMenu:this.length_menu},bScrollCollapse:!0,bAutoWidth:!1,iDisplayLength:this.filter_value,sWrapper:"dataTables_wrapper form-inline",fnDrawCallback:$.proxy(function(){this.dataTable!=null&&(this.show(),this.findSortedColumns())},this)};r!=null&&(i.aaSorting=r),typeof this.searchTerm!="undefined"&&this.searchTerm!=null&&(i.oSearch={sSearch:this.searchTerm},this.searchTerm=null),this.dataTable=$(this.container).dataTable(i),$(window).trigger("resize"),$(this.container).next(".row-fluid").find(".span6:last").append('<a class="btn btn-large-custom pull-right spacing-right"><i class="icon-plus" id="'+$(this.container).attr("id")+"-add-new"+'"></i></a>'),this.generateFieldsDropdown("Fields",$(t).find(".fields"));var s=$(t).find(".length_select");$(s).change($.proxy(function(){this.filter_value=$(s).val(),localStorage.setItem(this.localStorageLengthKey,$(s).val())},this)),$(t).find(".jqtransform").jqTransform(),$(t).find(".jqtransform").find("select").css("display","none"),$(t).find("div.jqTransformSelectWrapper ul li a").click($.proxy(function(e,n){var r=$(t).find("div.jqTransformSelectWrapper span").text();return this.filter_value=r,$(s).val(r),$(s).trigger("change"),$(window).trigger("resize"),!1},this)),$(this.container).find("a.delete-button").live("click",$.proxy(function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation();var t=$($(e.target).get(0)).parent("th").parent("tr").get(0);this.confirmDialog("Are you sure you want to delete this object?",$.proxy(function(){this.deleteObject(t)},this))},this)),this.initialize=!1,this.redraw=!1,this.handleAdd()},confirmDialog:function(e,t){if(typeof this.storedVariables["confirm-dialog"]!="undefined"){var n=this.storedVariables["confirm-dialog"].modal;n.find(".modal-body").html(e),n.modal("show"),$(n).find(".modal-footer .btn-primary").click(function(e){typeof t=="function"&&$($(e.target).get(0)).hasClass("btn-primary")&&t()})}else{var n=$('<div class="modal hide"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h3>Are you sure?</h3></div><div class="modal-body"></div><div class="modal-footer"><a href="#" class="btn" data-dismiss="modal">Cancel</a><a href="#" data-dismiss="modal" class="btn btn-primary">Yes</a></div></div>'),r=this.randomString(6);this.storedVariables["confirm-dialog"]={id:r},n.attr("id",r),n.find(".modal-body").html(e),$("body").append(n),n.modal("show"),console.log(),$(n).find(".modal-footer .btn-primary").click(function(e){typeof t=="function"&&$($(e.target).get(0)).hasClass("btn-primary")&&t()}),this.storedVariables["confirm-dialog"].modal=n}},deleteObject:function(e){var e=$(e),t=this.root+this.requestType+"/{id}";$.ajax({url:this.createAutherizedUrl(t.replace("{id}",e.attr("data-index"))),type:"DELETE",success:$.proxy(function(t){delete this.response[this.findByProperty("id",e.attr("data-index"),this.response)],this.refreshTable()},this)})},handleAdd:function(){$("#"+$(this.container).attr("id")+"-add-new").live("click",$.proxy(function(){},this))},createModalFromObject:function(e,t,n){e=$(e);if(n==undefined)if(objx.get(this.storedVariables,"modals."+e.attr("id"))==null||objx.get(this.storedVariables,"modals."+e.attr("id")+".id")==undefined)var n=this.randomString(6);else var n=objx.get(this.storedVariables,"modals."+e.attr("id")+".id");else objx.set(this.storedVariables,"modals."+e.attr("id")+".id",n);if($("#"+n).length<0||$("#"+n).length==0){var r=$(e).clone();objx.set(this.storedVariables,"modals."+e.attr("id")+".id",n),objx.set(this.storedVariables,"modals."+e.attr("id")+".type","normal"),r.attr("id",n),r.attr("data-template",e.attr("id")),e.after(r),r.modal({keyboard:!0,show:!1})}else var r=$("#"+n);return this.clearModal(r),e.attr("data-save-endpoint")&&objx.set(this.storedVariables,"modals."+e.attr("id")+".request_type",e.attr("data-save-endpoint")),$("#"+n).find(".modal-footer").find(".btn-primary").live("click",$.proxy(function(t){var n=objx.get(this.storedVariables,"modals."+e.attr("id")+".request_type")||this.save_request_type||this.requestType||null;this.saveModal(r,n)},this)),r.find("[data-add-model]").live("click",$.proxy(function(){var e=$(event.target),t=e.prev("input,select")[0];if(e.attr("data-add-model")!=""){if(objx.get(this.storedVariables.modals,e.attr("data-add-model")+".id")==null){var n=this.createModalFromObject($("#"+e.attr("data-add-model")),null);n!=null&&n!=undefined&&objx.set(this.storedVariables.modals,e.attr("data-add-model")+".id",n)}else $("#"+objx.get(this.storedVariables.modals,e.attr("data-add-model")+".id")).modal("show");this.clearModal($("#"+objx.get(this.storedVariables.modals,e.attr("data-add-model")+".id"))),this.runHandler(e,$("#"+objx.get(this.storedVariables.modals,e.attr("data-add-model")+".id"))),objx.set(this.storedVariables.modals,e.attr("data-add-model")+".type","add"),objx.set(this.storedVariables.modals,e.attr("data-add-model")+".parent_modal",r.attr("id")),objx.set(this.storedVariables.modals,e.attr("data-add-model")+".input_element",t),objx.set(this.storedVariables.modals,e.attr("data-add-model")+".property",e.attr("data-property")),objx.set(this.storedVariables.modals,e.attr("data-add-model")+".response_key",e.attr("data-response-key"))}},this)),r.modal("show"),n},clearModal:function(e){var e=$(e);e.find("input").each(function(e,t){$(t).val("")}),e.find("select").each(function(e,t){$(t).find("option:eq(0)").attr("selected","selected"),$(t).trigger("change")})},saveModal:function(e,t){var n={};e=$(e[0]),e.find("[data-name]").each(function(e,t){objx.set(n,$(t).attr("data-name"),$(t).val())});var r=t||this.save_request_type||this.requestType||null,i=$(e.find("table").find('[name="id"]'));if(r!=null&&this.countProperties(n)!==0&&n!=undefined){var s="POST";if(i.length>0&&i!=null&&i.val()!=""){s="PUT";var o=this.root+r+"/"+i.val()}else var o=this.root+r;o.indexOf("http")==-1&&(o=window.location.protocol+"://"+o),$.ajax({url:this.createAutherizedUrl(o),data:JSON.stringify(n),type:s,success:$.proxy(function(t){e.modal("hide"),objx.get(this.storedVariables.modals,e.attr("data-template")+".type")=="add"?this.processAdd(e,t):this.processSave(e,t)},this),error:$.proxy(function(){this.showError("Sorry an error encountered! Try again!",e.find(".modal-body"))},this)})}},processAdd:function(e,t){var n=objx.get(this.storedVariables.modals,e.attr("data-template"));if($(n.input_element).is("input"))$(n.input_element).val(objx.get(t,n.response_key+"."+n.property));else{var r=new Option(objx.get(t,n.property),objx.get(t,"id"));$(r).html(objx.get(t,n.property)),$(n.input_element).append(r),$(n.input_element).val(objx.get(t,"id"))}},findByProperty:function(e,t,n){for(var r=this.countProperties(n)-1;r>=0;r--)if(objx.get(n[r],e)==t)return r},processSave:function(e,t){var n=objx.get(this.storedVariables.modals,e.attr("id")+".launch_element"),r=this.findByProperty("id",$(n).attr("data-index"),this.response);console.log(this.response[r]),this.response[r]=t[this.responseNode],this.refreshTable(),console.log(this.response)},showError:function(e,t){t=t||$("body"),t=$(t),$(t).find(".request_error").length<=0&&$(t).prepend('<div class="request_error alert fade in"></div>'),$(t).find(".request_error").css("display","block"),$(t).find(".request_error").html(""),$(t).find(".request_error").append('<button type="button" class="close" data-dismiss="alert">&times;</button><strong>'+e+"</strong>"),$(t).find(".request_error").alert(),$(t).find(".request_error").bind("closed",function(){$(".request_error").css("display","none"),$(window).trigger("resize")}),$(window).trigger("resize")},tableRowClicked:function(e){var e=$(e).parent("tr");if(e.find("td").hasClass("dataTables_empty")!=1&&e.find("td").hasClass("dataTables_empty")!="true"){var t=this.createModalFromObject($(this.onCickModal),null,this.modal_id_name),n=$(this.onCickModal).html();n=n.replace(/\{([a-zA-Z_\.]*)\}/g,$.proxy(function(t,n,r,i){return this.response!=undefined&&objx.get(this.response[e.attr("data-index")],n)!=null?objx.get(this.response[e.attr("data-index")],n):""},this)),$("#"+t).html(n),typeof e!=undefined&&this.runHandler(e,$("#"+t)),objx.set(this.storedVariables.modals,t+".launch_element",e),$("#"+t).modal("show")}},createModal:function(){$(this.container).find(".edit-button").live("click",$.proxy(function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation();if($(e.target).attr("data-launch")=="false")return;this.tableRowClicked($(e.target).parent("th"))},this)),$(this.container).find("tbody tr").live("click",$.proxy(function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation();if(typeof e.target!="undefined"){var t=$(e.target).get(0);if($(t).is("th")){if($(t).find("a").attr("data-launch")=="false")return}else if($(t).attr("data-launch")=="false")return;this.tableRowClicked(t)}},this))},buildHandlerUrl:function(e){var t=e.url;t.indexOf("http")==-1&&(t=window.location.protocol+"://"+t),objx.get(e,"query_parameters")!=null&&(t.indexOf("?")==-1&&(t+="?"),$.each(e.query_parameters,function(e,n){n.indexOf("#")!=-1?t+=e+"="+$(n).val()+"&":t+=e+"="+n+"&"}));if(objx.get(e,"fill_values")!=null){t.indexOf("?")==-1&&(t+="?");var n="#"+this.modal_id_name;$.each(e.fill_values,function(e,r){r=$(n).find(r),$(r).length>0&&$(r).val()!=null&&$(r).val()!=undefined&&(t+=e+"="+$(r).val()+"&")})}return t},runObjectHandlers:function(e,t,n,r){if(t!=null)if(typeof t.type=="undefined"||t.type=="select"){var i=this.buildHandlerUrl(t);i.indexOf("&")!=-1&&(i=i.slice(0,i.length-1)),$.ajax({url:this.createAutherizedUrl(i),success:$.proxy(function(e){objx.get(t,"response_key")!=null&&(e=e[t.response_key],t.response=e,this.handlers[r].response=e),$(n).find('[data-handler="'+r+'"]').each(function(n,r){r=$(r).find("select"),$(r).html(""),$.each(e,function(e,n){$(r).attr("data-selected")==objx.get(n,"id")?$(r).append('<option selected value="'+objx.get(n,"id")+'">'+objx.get(n,t.property)+"</option>"):$(r).append('<option value="'+objx.get(n,"id")+'">'+objx.get(n,t.property)+"</option>")}),r.parent("form").length>0&&(r.parent("form").find("div ul").css("height","70px"),r.parent("form").jqTransform())})},this)})}else if(t.type=="typeahead"){var s=this;n.find('[data-handler="'+r+'"]').each(function(e,n){n=$(n).find(".typeahead"),n.typeahead({source:function(e,n){var r=s.buildHandlerUrl(t);typeof t.query_key!="undefined"&&n!=null&&n!=""&&(r.indexOf("?")!=-1?r.indexOf("&")!=-1?r+=t.query_key+"="+n+"&":r+=t.query_key+"="+n+"&":r+="?"+t.query_key+"="+n),r!=null&&r.indexOf("&")!=-1&&(r=r.slice(0,r.length-1)),r=s.createAutherizedUrl(r);if(r!=null&&r!=undefined)return $.get(s.createAutherizedUrl(r),function(n){if(objx.get(t,"response_key")!=null)return n=n[t.response_key],e.process(n)})},property:t.property})})}},runHandlers:function(e){this.modals!=undefined&&this.handlers!=undefined&&$.each(this.modals,$.proxy(function(t,n){$.each(this.handlers,$.proxy(function(t,r){this.runObjectHandlers(e,r,n.id,t)},this))},this))},runHandler:function(e,t){$.each(this.handlers,$.proxy(function(n,r){this.runObjectHandlers(e,r,$(t),n)},this))},refreshTable:function(){this.response!=null&&this.countProperties(this.response)>0?(this.searchTerm=$(this.container).parent("div").find(".row-fluid:first .span4:last").find(".dataTables_filter label input").val(),this.container.find("thead").html(""),this.generateColumns(),this.container.find("tbody").html(""),this.dataTable.fnClearTable(),this.dataTable.fnDestroy(),$.each(this.response,$.proxy(function(e,t){typeof t!="undefined"&&typeof t.id!="undefined"&&this.generateNode(t,t.id),e==this.response.length-1&&this.initializeDatatables(!1)},this))):(this.container.find("thead").html(""),this.generateColumns(),this.noValuesFill()),this.fixedHeader.fnPosition(),$(window).trigger("scroll"),$(window).trigger("resize")},noValuesFill:function(){$(this.container).find("tbody tr:first").find(".dataTables_empty").length>0&&$(this.container).find("tbody tr:first").find(".dataTables_empty").attr("colspan",$(this.container).find("thead tr th").size())}};var userInfo={getInfo:function(e,t,n){t=t||this.token||null,info=null,$.ajax({url:this.createAutherizedUrl(e,t),success:function(e){info=e,typeof n=="function"&&n(e,"ok")},error:function(){n(null,"fail")}})},getCookie:function(e){var t,n,r,i=document.cookie.split(";");for(t=0;t<i.length;t++){n=i[t].substr(0,i[t].indexOf("=")),r=i[t].substr(i[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,"");if(n==e)return unescape(r)}},setCookie:function(e,t,n){var r=new Date;r.setDate(r.getDate()+n);var i=escape(t)+(n==null?"":"; expires="+r.toUTCString());document.cookie=e+"="+i},createAutherizedUrl:function(e,t){return t=t||this.token,t!=null&&(e.indexOf("?")==-1?e+="?":e+="&",e+="token="+t),e}},application={unitsGenerator:null,computerGenerator:null,locationGenerator:null,printerGenerator:null,screenGenerator:null,organization:null,generators:{},settings:null,ready:0,callback:null,addGenerator:function(e,t){this.generators[t]=e},initialize:function(e,t){application.callback=t,application.organization=e,application.settings=new settings(e),application.settings=application.settings;if(userInfo.getCookie("token")==undefined||userInfo.getCookie("token")==null){window.location=root+"home/login";return}userInfo.getInfo(root+"user/me",userInfo.getCookie("token"),function(e,t){if(t=="fail"){window.location=root+"logout/reset";return}application.computerGenerator=new tableGenerator({requestType:"computer",container:$("#computer"),columns:application.settings.computerColumns,responseNode:"Computer",multipleResponseNode:"Computers",localStorageColumnsKey:"computer_columns",multipleRequestType:"computers",root:root,modal:$("#edit_computer"),localStorageLengthKey:"computer_length_value",handlers:{model_type:application.settings.handlers.device_type,model:application.settings.handlers.computer_model,screen_size:application.settings.handlers.screen_size,location:application.settings.handlers.location,manufacturer:application.settings.handlers.manufacturer},callback:application.readyCallback}),application.addGenerator(application.computerGenerator,"computerGenerator"),application.locationGenerator=new tableGenerator({requestType:"location",modal:$("#edit_location"),container:$("#location"),localStorageLengthKey:"location_length_value",columns:application.settings.locationColumns,responseNode:"Location",multipleResponseNode:"Locations",multipleRequestType:"locations",localStorageColumnsKey:"location_columns",root:root,handlers:{floor:application.settings.handlers.floor,building:application.settings.handlers.building},callback:application.readyCallback}),application.unitsGenerator=new tableGenerator({requestType:"device",container:$("#unit"),modal:$("#edit_unit"),columns:application.settings.unitColumns,responseNode:"Device",multipleResponseNode:"Devices",multipleRequestType:"devices",root:root,localStorageColumnsKey:"unit_columns",localStorageLengthKey:"unit_length_value",handlers:{location:application.settings.handlers.location,model_type:application.settings.handlers.device_type,model:application.settings.handlers.device_model},callback:application.readyCallback}),application.printerGenerator=new tableGenerator({modal:$("#edit_printer"),requestType:"printer",localStorageLengthKey:"printer_length_value",container:$("#printer"),columns:application.settings.printerColumns,responseNode:"Printer",multipleResponseNode:"Printers",localStorageColumnsKey:"printer_columns",multipleRequestType:"printers",root:root,handlers:{location:application.settings.handlers.location,model:application.settings.handlers.printer_model},callback:application.readyCallback}),application.screenGenerator=new tableGenerator({requestType:"screen",modal:$("#edit_screen"),localStorageLengthKey:"screen_length_value",localStorageColumnsKey:"screen_columns",container:$("#screen"),columns:application.settings.screenColumns,responseNode:"Screen",multipleResponseNode:"Screens",multipleRequestType:"screens",root:root,handlers:{location:application.settings.handlers.location},callback:application.readyCallback}),application.launch(),$(".dataTables_filter").find("input").addClass("input-large")})},launch:function(){$.each(application.generators,function(e,t){t.getNodes(application.organization)})},countProperties:function(e){var t,n=0;for(t in e)n++;return n},readyCallback:function(){application.ready+=1,application.ready==application.countProperties(application.generators)&&typeof application.callback=="function"&&application.callback()}},unitsGenerator,computerGenerator,locationGenerator,printerGenerator,screenGenerator=null,data={computer:"computers",printer:"printers",units:"units",screens:"screens",users:"users",locations:"locations"},generators={computers:"computerGenerator",printers:"printerGenerator",units:"unitsGenerator",locations:"locationGenerator",screens:"screenGenerator"};if(typeof history.pushState=="undefined")var History=window.History;$(".nav li a").live("click",function(e){var t,n,r;e.preventDefault(),e.target.nodeName=="A"&&(n=e.target.getAttribute("data-target"),t=e.target.getAttribute("data-title"),History.pushState(data[n],t,data[n]))}),$(window).ready(function(){$(".logout").live("click",function(){window.location=root+"logout"}),initialize(),History.Adapter.bind(window,"statechange",function(){showPage()}),application.initialize(1,function(){$("#loading-background").remove(),$("#loading").hide(),showPage()})});